version: '3.4'

# services:
#   csms:
#     environment:
#       - ASPNETCORE_ENVIRONMENT=Development
#       - ASPNETCORE_URLS=https://+:443;http://+:80
#     ports:
#       - "80"
#       - "443"
#     volumes:
#       - ${APPDATA}/Microsoft/UserSecrets:/root/.microsoft/usersecrets:ro
#       - ${APPDATA}/ASP.NET/Https:/root/.aspnet/https:ro

services:
  postgresql:
    container_name: postgres
    image: postgres
    volumes:
        - ./docker/pg:/var/lib/postgresql
    environment:
        POSTGRES_USER: postgres
        POSTGRES_PASSWORD: postgres
        POSTGRES_DB: CustomerMS
    ports:
      - '5432:5432'

  nginx:
    image: nginx:latest 
    container_name: nginx
    ports:
      - "80:80" 
    volumes:
      - ./nginx:/etc/nginx/conf.d 
    restart: always 

  nodejs:
    image: node:18.17.1 
    container_name: node.js 
    working_dir: /usr/src/app 
    volumes:
      - D:/CSMS/CSMS/app:/usr/src/app 
    ports:
      - "3000:3000" 
    environment:
      - NODE_ENV=production 
    command: ["npm", "start"]  

  pgadmin:
    image: dpage/pgadmin4
    restart: always
    ports:
      - "8888:80"
    environment:
      TZ: Asia/Tokyo
      PGADMIN_DEFAULT_EMAIL: 'naha022677@icloud.com'
      PGADMIN_DEFAULT_PASSWORD: 'postgres'